devtools::load_all(".")
resultS <- lodmatrix2scanone(result, N2xCB4856.cross)
peaks <- get_chr_peaks(N2xCB4856.cross, result)
peaks2 <- get_peaks_above_thresh(resultS, N2xCB4856.cross)
View(maf)
View(wis)
ce <- wis %>% filter(SPECIES == "Caenorhabditis elegans")
View(ce)
View(resultS)
devtools::load_all(".")
peaks2 <- get_peaks_above_thresh(resultS, FDR)
View(resultS)
lods <- resultS
lapply(colnames(3:ncol(lods)), function(x){
print(x)
})
colnames(3:ncol(lods))
View(lods)
colnames(lods)
peaks2 <- get_peaks_above_thresh(resultS, FDR)
devtools::load_all(".")
peaks2 <- get_peaks_above_thresh(resultS, FDR)
3:ncol(lods)
devtools::load_all(".")
peaks2 <- get_peaks_above_thresh(resultS, FDR)
FDR <- 3.5
peaks2 <- get_peaks_above_thresh(resultS, FDR)
View(peaks2)
View(peaks2)
devtools::load_all(".")
peaks2 <- get_peaks_above_thresh(resultS, FDR)
View(peaks2)
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
devtools::load_all(".")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
resultS <- lodmatrix2scanone(result, N2xCB4856.cross)
peaks <- maxpeaks(N2xCB4856.cross, resultS)
peaks2 <- get_peak_array(peaks, 3.5)
load("~/Dropbox/AndersenLab/RCode/Linkage mapping/N2xCB4856_RIAILs_Rqtlfiles.RData")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
resultS <- lodmatrix2scanone(result, N2xCB4856.cross)
peaks <- maxpeaks(N2xCB4856.cross, resultS)
peaks2 <- get_peak_array(peaks, 3.5)
debug(get_peak_array)
peaks2 <- get_peak_array(peaks, 3.5)
keepPeaks = which(peaklist$maxpeaklod>threshold, arr.ind=T)
peaks2 <- get_peak_array(peaks, 3.5)
devtools::load_all(".")
peaks2 <- get_peak_array(peaks, 3.5)
View(peaks2)
View(resultS)
?abind
??abind
devtools::load_all(".")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
View(result)
N2xCB4856.cross$geno
View(N2xCB4856.cross$geno)
load("~/Dropbox/AndersenLab/RCode/Linkage mapping/N2xCB4856_RIAILs_Rqtlfiles.RData")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs1_processed.rds")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
devtools::load_all(".")
load("~/Dropbox/AndersenLab/RCode/Linkage mapping/N2xCB4856_RIAILs_Rqtlfiles.RData")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs1_processed.rds")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
View(result)
cross <- N2xCB4856.cross
presids <- extract_scaled_phenotype(cross)
View(presids)
pdata <- extract_scaled_phenotype(cross)
map <- result
lods <- map[,3:ncol(map)]
View(lods)
View(pheno)
cor()
cor
geno <- extract_genotype(cross)
View(geno)
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
devtools::load_all(".")
load("~/Dropbox/AndersenLab/RCode/Linkage mapping/N2xCB4856_RIAILs_Rqtlfiles.RData")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs1_processed.rds")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs1_processed.rds")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
FDR <- 3.5
cross <- N2xCB4856.cross
map <- result
threshold = FDR
intercept <- FALSE
pheno <- extract_scaled_phenotype(cross)
lods <- map[,3:ncol(map)]
geno <- extract_genotype(cross)
pheno <- data.frame(extract_scaled_phenotype(cross))
lods <- map[,3:ncol(map)]
geno <- data.frame(extract_genotype(cross))
View(pheno)
View(geno)
View(map)
View(lods)
traitsabovethresh <- sapply(lods, function(x){
if(max(x)>threshold){
return(names(x))
}
})
traitsabovethresh <- sapply(1:ncol(lods), function(x){
if(max(lods[x])>threshold){
return(colnames(lods[x]))
}
})
lods <- data.frame(map[,3:ncol(map)])
lods <- data.frame(map[,3:ncol(map)])
traitsabovethresh <- sapply(1:ncol(lods), function(x){
if(max(lods[x])>threshold){
return(colnames(lods[x]))
}
})
tat <- unlist(traitsabovethresh)
traitsabovethresh <- lapply(1:ncol(lods), function(x){
if(max(lods[x])>threshold){
return(colnames(lods)[x])
}
})
tat <- unlist(traitsabovethresh)
maxsnp <- vapply(tat, function(x){
which.max(lods[,x])
}, numeric(1))
devtools::load_all(".")
FDR <- get_peak_fdr(peaks, N2xCB4856.cross, 10, doGPU=F)
peaks <- maxpeaks(resultS, N2xCB4856.cross)
peaks <- maxpeaks(result, N2xCB4856.cross)
FDR <- get_peak_fdr(peaks, N2xCB4856.cross, 10, doGPU=F)
debug(get_peak_fdr)
FDR <- get_peak_fdr(peaks, N2xCB4856.cross, 10, doGPU=F)
View(lods)
FDR <- get_peak_fdr(result, N2xCB4856.cross, 10, doGPU=F)
library(foreach)
FDR <- get_peak_fdr(result, N2xCB4856.cross, 10, doGPU=F)
FDR <- get_peak_fdr(result, N2xCB4856.cross, 10, doGPU=F)
maxpeaks(lods)
peaklods <- maxpeaks(lods)$maxpeaklod
pheno <- extract_scaled_phenotype(cross)
geno <- extract_genotype(cross)
npheno <- count_strains_per_trait(pheno)
# Change dopar for multithreaded
permpeakLODs <- foreach( i = 1:perms ) %do% {
print(i)
lods <- lodmatrix2scanone(get_lod_by_cor(npheno, pheno[sample(1:nrow(pheno)),], geno, doGPU), cross)
maxpeaks(cross, lods)$maxpeaklod
}
devtools::load_all(".")
devtools::load_all(".")
debug(get_peak_fdr)
FDR <- get_peak_fdr(result, N2xCB4856.cross, 10, doGPU=F)
devtools::load_all(".")
debug(get_peak_fdr)
FDR <- get_peak_fdr(result, N2xCB4856.cross, 10, doGPU=F)
i = 1
print(i)
lods <- lodmatrix2scanone(get_lod_by_cor(npheno, pheno[sample(1:nrow(pheno)),], geno, doGPU), cross)
View(lods)
maxpeaks(cross, lods)$maxpeaklod
View(lods)
debug(maxpeaks)
maxpeaks(cross, lods)$maxpeaklod
devtools::load_all(".")
debug(get_peak_fdr)
FDR <- get_peak_fdr(result, N2xCB4856.cross, 10, doGPU=F)
devtools::load_all(".")
FDR <- get_peak_fdr(result, N2xCB4856.cross, 1000, doGPU=F)
test <- get_pheno_resids(N2xCB4856.cross, result, 3.5)
debug(get_pheno_resids)
test <- get_pheno_resids(N2xCB4856.cross, result, 3.5)
peaks <- data.frame(trait = tat, snp = maxsnp)
lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$maxsnp[x]]))
})
lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$maxsnp[x]]))
})
str(geno)
peaks$maxsnp[x]
x = 1
geno[,peaks$maxsnp[x]]
peaks$maxsnp[x]
peaks
View(peaks)
geno[,peaks$snp[x]
]
lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$snp[x]]))
})
presids <- data.frame(lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$snp[x]]))
}))
presids <- data.frame(lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$snp[x]], na.action = na.omit))
}))
?lm
presids <- data.frame(lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$snp[x]], na.action = na.exclude))
}))
View(presids)
colnames(presids <- peaks$trait)
colnames(presids) <- peaks$trait
if (intercept) {
presids <- data.frame(lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$snp[x]] - 1, na.action = na.exclude))
}))
} else {
presids <- data.frame(lapply(1:nrow(peaks), function(x) {
residuals(lm(pheno[,peaks$trait[x]]~geno[,peaks$snp[x]] - 1, na.action = na.exclude))
}))
}
devtools::load_all(".")
devtools::load_all(".")
test <- get_pheno_resids(N2xCB4856.cross, result, 3.5)
View(test)
load("~/Dropbox/AndersenLab/RCode/Linkage mapping/N2xCB4856_RIAILs_Rqtlfiles.RData")
N2xCB4856.cross$pheno
View(test)
View(result)
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
result <- map(N2xCB4856.cross)
peaks2 <- get_peak_array(peaks, 3.5)
debug(fsearch)
devtools::load_all(".")
devtools::load_all(".")
debug(fsearch)
fsearch(N2xCB4856.cross, result, 10)
View(lods)
?gather
View(lods)
View(cross$pheno)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
resids <- get_pheno_resids(cross, lods, fdr)
lodslist <- list()
lodslist <- append(lodslist, lods)
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lsj2 <- c("~/Dropbox/HTA/Results/20150706_McGrathRILs1a/", "~/Dropbox/HTA/Results/20150707_McGrathRILs1b/")
processMany(lsj2, "McGrathRILs_processed")
library(dplyr)
library(easysorter)
processMany <- function(rilsdirs, filename) {
rilsdata <- lapply(rilsdirs, read_data)
rilswithoutcontam <- lapply(rilsdata, function(x) {
x[[1]] <- filter(x[[1]], !contamination)
return(x)
})
sumrils <- lapply(rilswithoutcontam, function(x) sumplate(x, quantiles = TRUE))
onerils <- rbind_all(sumrils) %>% select(-contains("green"))
bioprunedrils <- onerils %>%
filter(n > 5, n < 1000, norm.n < 350) %>%
group_by(condition) %>%
filter(length(unique(assay)) > 1)
assayregressedrils <- regress(bioprunedrils, assay = TRUE)
prunedrils <- bamf_prune(assayregressedrils, drop = TRUE) %>%
select(-bamfoutlier1, -bamfoutlier2, -bamfoutlier3)
regressedrils <- regress(prunedrils)
saveRDS(regressedrils, paste0("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/", filename, ".rds"))
}
processMany(lsj2, "McGrathRILs_processed")
processMany(lsj2, "McGrathRILs_processed")
fsearch
devtools::load_all(".")
debug(fsearch)
fsearch(N2xCB4856.cross, result, 10)
fsearch(N2xCB4856.cross, result, 10)
class(lods)
class(data.frame(lods))
lodslist <- append(lodslist, data.frame(lods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lodslist <- append(lodslist, data.frame(lods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lodslist <- append(lodslist, data.frame(lods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lodslist <- append(lodslist, data.frame(lods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lodslist <- append(lodslist, data.frame(lods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
View(lodslist[[1]])
fsearch(N2xCB4856.cross, result, 10)
lodslist <- list()
peaks <- get_peaks_above_thresh(lods, fdr)
lodslist <- append(lodslist, list(lods))
lodslist[[1]]
View(lodslist[[1]])
lodswiththresh <- cbind(lods, fdr) %>% dplyr::mutate(marker = rownames(.))
lods <- data.frame(lods)
lods <- data.frame(lods)
lodswiththresh <- cbind(lods, fdr) %>%
dplyr::mutate(marker = rownames(.), threshold = fdr)
View(lodswiththresh)
colnames(lodswiththresh)
lodswiththresh$marker
lodswiththresh$threshold
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lods, threshold)
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lod, threshold)
View(meltedlods)
lodslist <- append(lodslist, list(meltedlods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lods <- data.frame(lods)
lodswiththresh <- cbind(lods, fdr) %>%
dplyr::mutate(marker = rownames(.), threshold = fdr)
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lod, threshold)
lodslist <- append(lodslist, list(meltedlods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lodslist[[1]] <- NULL
lods <- data.frame(lods)
lodswiththresh <- cbind(lods, fdr) %>%
dplyr::mutate(marker = rownames(.), threshold = fdr)
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lod, threshold)
lodslist <- append(lodslist, list(meltedlods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lods <- data.frame(lods)
lodswiththresh <- cbind(lods, fdr) %>%
dplyr::mutate(marker = rownames(.), threshold = fdr)
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lod, threshold)
lodslist <- append(lodslist, list(meltedlods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lods <- data.frame(lods)
lodswiththresh <- cbind(lods, fdr) %>%
dplyr::mutate(marker = rownames(.), threshold = fdr)
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lod, threshold)
lodslist <- append(lodslist, list(meltedlods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
lods <- data.frame(lods)
lodswiththresh <- cbind(lods, fdr) %>%
dplyr::mutate(marker = rownames(.), threshold = fdr)
meltedlods <- tidyr::gather(lodswiththresh, trait, lod, -chr, -pos, -marker, -threshold) %>%
select(marker, chr, pos, trait, lod, threshold)
lodslist <- append(lodslist, list(meltedlods))
resids <- get_pheno_resids(cross, lods, fdr)
metapheno <- cross$pheno[1:5]
cross$pheno <- data.frame(metapheno, resids)
lods <- map(cross)
fdr <- get_peak_fdr(lods, cross, iterations, doGPU=F)
peaks <- get_peaks_above_thresh(lods, fdr)
}
View(peaks)
test <- do.call(rbind, lodslist)
View(test)
class(test)
test2 <- test %>% group_by(marker, trait) %>% filter(max(lod))
test2 <- test %>% group_by(marker, trait) %>% filter(lod == max(lod))
View(test2)
range(test2$threshold)
summary(test2$threshold)
unique(test2$threshold)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, result, 10)
View(test)
debug(fsearch)
test <- fsearch(N2xCB4856.cross, result, 10)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, result, 10)
test <- fsearch(N2xCB4856.cross, result, 10)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, result, 10)
source('~/LinkageMapping/R/LOD.R')
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
fsearch
devtools::load_all(".")
fsearch
library(foreach)
# Load in the rqtl files
load("~/Dropbox/AndersenLab/RCode/Linkage mapping/N2xCB4856_RIAILs_Rqtlfiles.RData")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs1_processed.rds")
pheno <- readRDS("~/Dropbox/AndersenLab/LabFolders/PastMembers/Tyler/ForTrip/RIAILs2_processed.rds")
pheno <- mapformat(pheno)
devtools::load_all(".")
pheno <- mapformat(pheno)
N2xCB4856.cross$pheno <- mergepheno(N2xCB4856.cross, pheno)
test <- fsearch(N2xCB4856.cross, 10)
View(cross$pheno)
View(N2xCB4856.cross$pheno)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
test <- fsearch(N2xCB4856.cross, 10)
View(map)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
View(test)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
View(test)
devtools::load_all(".")
fsearch
devtools::load_all(".")
fsearch
devtools::load_all(".")
fsearch
devtools::load_all(".")
test <- fsearch(N2xCB4856.cross, 10)
View(test)
devtools::load_all(".")
debug(annotate_lods)
annotate_lods(test, N2xCB4856.cross)
View(lods)
peaks <- lods %>% dplyr::group_by(trait, iteration) %>% dplyr::filter(lod == max(lod))
View(peaks)
peaks <- lods %>%
dplyr::filter(lod > threshold) %>%
dplyr::group_by(trait, iteration) %>%
dplyr::filter(lod == max(lod))
View(peaks)
t <- extract_genotype(N2xCB4856.cross)
View(t)
annotate_lods(test, N2xCB4856.cross)
